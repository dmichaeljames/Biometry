---
title: "HW7"
author: "Judith Rodriguez"
date: "April 15, 2019"
output: html_document
---

FINAL MAY 8th, MAY 13th (MAY BE RESCHEDULED)



#ANCOVA
ancova.results.aov <- aov(Y~X*Covar)
MyDataSet#Covariate <- as.factor(MyDataSet$Covariate)
3 null hypothesis:
Are regression lines parallel among groups?
Do groups?


```{r}
library(ISwR)
hellung[c(1:4, 49:51), ]
summary(hellung)
#Glucose is coded and 1 or 2 (yes or no)
hellung$glucose <- factor(hellung$glucose, labels = c("Yes","No"))
summary(hellung)
```

```{r}
attach(hellung)
plot(conc,diameter,pch=as.numeric(glucose))
legend(locator(n=1), legend=c("glucose","no glucose"), pch=1:2)
```

```{r}
plot(conc, diameter, pch=as.numeric(glucose), log="xy")
legend(locator(n=1), legend=c("glucose","no glucose"), pch=1:2)
```

```{r}
library(car)
scatterplot(diameter~conc|glucose, hellung) 
```
default dotted in moving of the fitted average
```{r}
scatterplot(log(diameter)~log(conc)|glucose, hellung)
#The fit is so much better after using log
```


```{r}
plot(log10(conc),log10(diameter),pch=as.numeric(glucose))

#Split data by glucose	
tethym.gluc <- hellung[glucose=="Yes", ]
tethym.nogluc <-hellung[glucose=="No", ] 

#Plot separate regression lines	
lm.nogluc <- lm(log10(diameter)~ log10(conc), data=tethym.nogluc)
lm.gluc <- lm(log10(diameter)~log10(conc), data=tethym.gluc)
abline(lm.nogluc)
abline(lm.gluc)
```
At high concentrations, we collect a few extra small diamters while at a lower concentration, we collect wider ones.

So is this true?
Run factorial model
```{r}
#Simple linear model approach
summary(lm(log10(diameter)~log10(conc)*glucose))
```
We care about log10(conc):glucoseNo, the Interaction between conc and presence or absens eof gluc. 0.185 fails to reject the null hypothesis of interaction and the slopes are significant differnet from eachother. Each grouping does not have different slopes but they have the same slope.

So let's look at it using aov.
```{r}
summary(aov(log10(diameter)~log10(conc)*glucose))
#aov() and lm() are the same but aov() gives you the mean of sqaures while lm() gives you the R-squared.
```

```{r}
#change to an additive model
summary(aov(log10(diameter)~log10(conc)+glucose))
```
There is still significance with this model. Glucose is also significant. In glucose, it means that even thought the slopes are the same the affect of glucose is significant. It does not matter where we are on that curve, in order for me to move from glucose to no glucose, you always add the same amount. The model between multiplication and additive have not changed much for the r-squared and adjusted r-squared. (Rsquared lets us know if we are over fitting the model.)

```{r}
#You can call the parameters using abline, so we know the lines have the same slope (b) and different intercepts (a)
plot(conc, diameter, pch=as.numeric(glucose), log="xy")
#legend(locator(n=1), legend=c("glucose","no glucose"), pch=1:2)
abline(a=1.642132, b=-0.055393)
abline(a=1.642132-0.028238, b=-0.055393)
```
```{r}
detach(hellung)
```