---
title: "LAB_4-29-2019"
author: "Michael James"
date: "April 29, 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# MANOVA  

> output <- manova(cbind(y1,y2,...) ~ Xi)

> cbind: binding (x,y,...) into a column

```{r}
y1 <- c(9,6,9,0,2,3,1,2)
y2 <- c(3,2,7,4,0,8,9,7)
g <- factor(c(1,1,1,2,2,3,3,3))

man <- manova(cbind(y1,y2) ~ g)
summary(man)
```

> Four version with which to run MANOVA

* Pillai's Trace (default)
* Wilk's 
* Roy's Root

```{r}
summary(man, test = "Wilks")
```

***

```{r}
attach(scheiner)
par(mfrow = c(1,2))
boxplot(NUM ~ TREAT, main = "WEEEEE")
boxplot(log10(MASS+1) ~ TREAT, main = "Transformed")
```

```{r}
plot(NUM, MASS, col=as.factor(TREAT), xlim=c(-2,200), ylim=c(-0.5,2),pch=16, cex=0.7, xlab = "Number of Seeds", ylab = "Mass of Seeds", main = "Number of Seeds VS. Mass of Seeds")
```

**The dot where the means coincide is the centroid**

### Now we perform the MANOVA

```{r}
# Combine the NUM and MASS into a column

scheiner.manova <- manova(cbind(NUM, MASS)~TREAT, scheiner)
summary(scheiner.manova)
manova.sum <- summary(scheiner.manova)
summary(scheiner.manova, test = "Roy")
```

### Roy's Greatest Root
```{r}
(H <- manova.sum$SS$TREAT)  
(E <- manova.sum$SS$Residuals)
(roy <- eigen(solve(E)%*%H))
yprime <- cbind(NUM,MASS)%*%roy$vectors
```

### Plot Group Histograms Along Roy's Greatest Root
```{r}
(roys.min <- min(yprime[,1]))
(roys.max <- max(yprime[,1]))
br <- seq(roys.min-0.5, roys.max+0.5, length=12)
g1hist <- hist(yprime[TREAT=="HIGH",1], breaks = br, plot=FALSE)
barplot(rbind(g1hist$counts))
detach(scheiner)
```

***
***
***


### MOVING ON TO HOMEWORK 8 CHIT CHAT (AKA POLYNOMIAL REGRESSION)

```{r}
library(car)

scatterplot(asin(sqrt(LAP))*180/pi ~ DIST, data=mytilus)

# Linearization would lead to a loss of information.

# Examine the residuals


plot(lm(asin(sqrt(LAP))*180/pi ~ DIST, data=mytilus), which = 1)

### Leaving Linear World and Moving into Poly World  

mytilus.lm5 <- lm(asin(sqrt(LAP))*180/pi ~ DIST + I(DIST^2) + I(DIST^3) + I(DIST^4)  + I(DIST^5), mytilus)

# Check it again  

plot(mytilus.lm5, which=1)

# Check ANOVA table for results

anova(mytilus.lm5)

# Compare and contrast different order models

mytilus.lm1 <- lm(asin(sqrt(LAP))*180/pi ~ DIST, mytilus)
mytilus.lm2 <- lm(asin(sqrt(LAP))*180/pi ~ DIST + I(DIST^2), mytilus)
anova(mytilus.lm2, mytilus.lm1)

mytilus.lm3 <- lm(asin(sqrt(LAP))*180/pi ~ DIST + I(DIST^2) + I(DIST^3), mytilus)
anova(mytilus.lm3, mytilus.lm2)
summary(mytilus.lm3)

plot(asin(sqrt(LAP))*180/pi ~ DIST, data = mytilus, pch=16)
x <- seq(0,80,l=1000)
points(x, predict(mytilus.lm3, data.frame(DIST=x)), type="l")
box(bty="l")
```

***

### LOGISTIC REGRESSION

> ratio = width X height of island